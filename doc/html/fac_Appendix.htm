<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">

<!--Converted with LaTeX2HTML 2018.3 (Released July 19, 2018) -->
<HTML lang="EN">
<HEAD>
<TITLE>Appendix</TITLE>
<META NAME="description" CONTENT="Appendix">
<META NAME="keywords" CONTENT="facilities">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.3">
   <link rel='apple-touch-icon' sizes='180x180' href='images/favicons/apple-touch-icon.png?v=2017'>
   <link rel='icon' type='image/png' sizes='32x32' href='images/favicons/favicon-32x32.png?v=2017'>
   <link rel='icon' type='image/png' sizes='16x16' href='images/favicons/favicon-16x16.png?v=2017'>
   <link rel='manifest' href='images/favicons/manifest.json?v=2017'>
   <link rel='mask-icon' href='images/favicons/safari-pinned-tab.svg?v=2017' color='#5bbad5'>
   <link rel='shortcut icon' href='images/favicons/favicon.ico?v=2017'>
   <meta name='apple-mobile-web-app-title' content='HEALPix'>
   <meta name='application-name' content='HEALPix'>
   <meta name='msapplication-config' content='images/favicons/browserconfig.xml?v=2017'>
   <meta name='theme-color' content='#ffffff'>

<LINK REL="STYLESHEET" HREF="facilities.css">

<LINK REL="next" HREF="fac_About_this_document.htm">
<LINK REL="previous" HREF="fac_ud_grade.htm">
<LINK REL="next" HREF="fac_About_this_document.htm">
</HEAD>

<body text="#000000" bgcolor="#FFFFFA">

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="fac_ud_grade.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="fac_HEALPix_F90_facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="fac_About_this_document.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html137"
  HREF="fac_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A
 HREF="fac_ud_grade.htm">ud_grade</A>

<B>Up:</B> <A
 HREF="fac_HEALPix_F90_facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A
 HREF="fac_About_this_document.htm">About this document ...</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A ID="tex2html139"
  HREF="fac_Appendix.htm#SECTION1610">Bug Correction in synfast 2.14</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A ID="SECTION1600"></A>
<A ID="fac:appendix"></A>
<BR>
Appendix
</H1>

<H2><A ID="SECTION1610"></A>
<A ID="fac:sec:bug_synder"></A>
<BR>
Bug Correction in synfast 2.14
</H2>
Thanks to the routine <A HREF="./sub_alm2map_der.htm#sub:alm2map_der"><TT>alm2map_der</TT></A>, the Fortran90 
<A HREF="fac_synfast.htm#fac:synfast"><TT>synfast</TT></A> 
facility  produces
maps of <SPAN CLASS="MATH"><I>I</I>,<I>Q</I>,<I>U</I></SPAN> Stokes parameters and their first and second spatial derivatives,
starting from <SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img100.png"
 ALT="$C(\ell)$"></SPAN> or <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="fac_img14.png"
 ALT="$a_{\ell m}$"></SPAN> coefficients.
<B>A bug affecting the calculation of <!-- MATH
 $\partial X/\partial\theta$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img15.png"
 ALT="$\partial X/\partial\theta$"></SPAN>, 
<!-- MATH
 $\partial^2 X/\partial \theta^2$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="fac_img17.png"
 ALT="$\partial^2 X/\partial \theta^2$"></SPAN>, 
<!-- MATH
 $\partial^2 X/(\partial\theta\partial\varphi\sin(\theta))$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="fac_img101.png"
 ALT="$\partial^2 X/(\partial\theta\partial\varphi\sin(\theta))$"></SPAN>, for <SPAN CLASS="MATH"><I>X</I>=(<I>Q</I>,<I>U</I>)</SPAN>
was detected in this routine and has been fixed in release 2.14 (March 2010).</B>

<P>
In what follows, the impact of this bug on the power spectra of
the produced maps is quantified, so that users can
assess how much their work could have been affected by this bug.

<P>

<DIV class="CENTER"><A ID="fig:bug_derQU"></A><A ID="4945"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 1:</STRONG>
Left panels: comparison of the EE power spectra <SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img100.png"
 ALT="$C(\ell)$"></SPAN> computed on polarized maps
derivatives generated by
<TT>synfast</TT>-2.13a (Old maps, blue bashes), the bug corrected <TT>synfast</TT>-2.14 (New maps, black lines)
and their differences (Diff maps, magenta lines). Note that what is plotted is
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img100.png"
 ALT="$C(\ell)$"></SPAN>, <EM>not</EM> the customary <!-- MATH
 $\ell(\ell+1)C(\ell)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img102.png"
 ALT="$\ell(\ell+1)C(\ell)/2\pi$"></SPAN>. Right panels show respectively
the relative error on the EE power spectrum of the old derivatives maps compared
to that of the new maps.
The red dashes show analytical fit to these errors.
</CAPTION>
<TR><TD>
<DIV CLASS="centerline" ID="par9329" ALIGN="CENTER">
<IMG STYLE=""
 SRC="IGimg1.png"
 ALT="Image error_der"></DIV>

<P></TD></TR>
</TABLE>
</DIV>
In Figure&nbsp;<A HREF="#fig:bug_derQU">1</A> we show the polarization <SPAN CLASS="MATH"><I>EE</I></SPAN> power spectrum of
<!-- MATH
 $N_{\mathrm{side}}= 1024$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>side</SUB>= 1024</SPAN> maps
in which the Stokes parameters <SPAN CLASS="MATH">(<I>Q</I>,<I>U</I>)</SPAN> have been replaced by, in turn, their derivatives
<!-- MATH
 $\partial (Q,U)/\partial\theta$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="fac_img103.png"
 ALT="$\partial (Q,U)/\partial\theta$"></SPAN>, 
<!-- MATH
 $\partial^2 (Q,U)/\partial \theta^2$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="fac_img104.png"
 ALT="$\partial^2 (Q,U)/\partial \theta^2$"></SPAN>, 
<!-- MATH
 $\partial^2 (Q,U)/(\partial\theta\partial\varphi\sin\theta)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="fac_img105.png"
 ALT="$\partial^2 (Q,U)/(\partial\theta\partial\varphi\sin\theta)$"></SPAN>, 
for maps generated
by either the version 2.13a of <TT>synfast</TT> or the corrected version 2.14, or
the difference of the two set of maps.
The input power spectra were those of WMAP-1yr <SPAN CLASS="MATH"><IMG STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="fac_img106.png"
 ALT="$\Lambda$"></SPAN>-CDM best fit model with a Gaussian
beam FWHM of 10 arcmin. The power spectra were computed on the whole maps, except
for 12 pixels around each pole that were masked out, because they get very
bright in second order derivatives.

<P>
It can be seen that the relative effect of the computation error on the produced maps was
large at low <SPAN CLASS="MATH"><IMG STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="fac_img5.png"
 ALT="$\ell$"></SPAN>, at scales on which derivatives maps contain little power, but decreasing
steadily with <SPAN CLASS="MATH"><IMG STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="fac_img5.png"
 ALT="$\ell$"></SPAN>.

<P>
It should be stressed that the following quantities were <EM>not</EM> affected by
the bug described above:
<DL COMPACT><DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the Stokes parameters themselves <SPAN CLASS="MATH">(<I>I</I>,<I>Q</I>,<I>U</I>)</SPAN>,
<DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the intensity <SPAN CLASS="MATH"><I>I</I></SPAN> and all its derivatives,
<DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the Laplacians <!-- MATH
 $\Delta I, \Delta Q$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.16ex; vertical-align: -0.55ex; " SRC="fac_img107.png"
 ALT="$\Delta I, \Delta Q$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.75ex; vertical-align: -0.10ex; " SRC="fac_img108.png"
 ALT="$\Delta U$"></SPAN>, with
<!-- MATH
 $\Delta \equiv \left(
\frac{\partial^2}{\partial\theta^2}
+ \cot\theta\frac{\partial}{\partial\theta} +
\frac{\partial^2}{\sin^2\theta\partial\varphi^2} 
\right)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 3.56ex; vertical-align: -1.26ex; " SRC="fac_img109.png"
 ALT="$\Delta \equiv \left(
\frac{\partial^2}{\partial\theta^2}
+ \cot\theta\frac{\partial}{\partial\theta} +
\frac{\partial^2}{\sin^2\theta\partial\varphi^2}
\right)$"></SPAN>.
</DL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="fac_ud_grade.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="fac_HEALPix_F90_facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="fac_About_this_document.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html137"
  HREF="fac_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A
 HREF="fac_ud_grade.htm">ud_grade</A>

<B>Up:</B> <A
 HREF="fac_HEALPix_F90_facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A
 HREF="fac_About_this_document.htm">About this document ...</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.50, 2018-12-10
</ADDRESS>
</BODY>
</HTML>
