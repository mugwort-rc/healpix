<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>alm.h Source File</title>
<link href="sheet.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>alm.h</h1><a href="alm_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> *  This file is part of Healpix_cxx.</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  Healpix_cxx is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> *  (at your option) any later version.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> *  Healpix_cxx is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> *  GNU General Public License for more details.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> *  along with Healpix_cxx; if not, write to the Free Software</span>
00016 <span class="comment"> *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> *  For more information about HEALPix, see http://healpix.jpl.nasa.gov</span>
00019 <span class="comment"> */</span>
00020 
00021 <span class="comment">/*</span>
00022 <span class="comment"> *  Healpix_cxx is being developed at the Max-Planck-Institut fuer Astrophysik</span>
00023 <span class="comment"> *  and financially supported by the Deutsches Zentrum fuer Luft- und Raumfahrt</span>
00024 <span class="comment"> *  (DLR).</span>
00025 <span class="comment"> */</span>
00026 <span class="comment"></span>
00027 <span class="comment">/*! \file alm.h</span>
00028 <span class="comment"> *  Class for storing spherical harmonic coefficients.</span>
00029 <span class="comment"> *</span>
00030 <span class="comment"> *  Copyright (C) 2003, 2004, 2005, 2006, 2007 Max-Planck-Society</span>
00031 <span class="comment"> *  \author Martin Reinecke</span>
00032 <span class="comment"> */</span>
00033 
00034 <span class="preprocessor">#ifndef PLANCK_ALM_H</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define PLANCK_ALM_H</span>
00036 <span class="preprocessor"></span>
00037 <span class="preprocessor">#include "<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/arr_8h.html">arr.h</a>"</span>
00038 <span class="comment"></span>
00039 <span class="comment">/*! Class for storing spherical harmonic coefficients. */</span>
<a name="l00040"></a><a class="code" href="classAlm.html">00040</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classAlm.html">Alm</a>
00041   {
00042   <span class="keyword">private</span>:
00043     <span class="keywordtype">int</span> lmax, mmax, tval;
00044     <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T&gt;</a> alm;
00045 
00046   <span class="keyword">public</span>:<span class="comment"></span>
00047 <span class="comment">    /*! Returns the number of coefficients in an Alm object with maximum</span>
00048 <span class="comment">        quantum numbers \a l and \a m. */</span>
<a name="l00049"></a><a class="code" href="classAlm.html#e0">00049</a>     <span class="keyword">static</span> <span class="keywordtype">long</span> <a class="code" href="classAlm.html#e0">Num_Alms</a> (<span class="keywordtype">int</span> l, <span class="keywordtype">int</span> m)
00050       {
00051       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#a1">planck_assert</a>(m&lt;=l,<span class="stringliteral">"mmax must not be larger than lmax"</span>);
00052       <span class="keywordflow">return</span> ((m+1)*(m+2))/2 + (m+1)*(l-m);
00053       }
00054 <span class="comment"></span>
00055 <span class="comment">    /*! Constructs an Alm object with given \a lmax and \a mmax. */</span>
<a name="l00056"></a><a class="code" href="classAlm.html#a0">00056</a>     <a class="code" href="classAlm.html#a0">Alm</a> (<span class="keywordtype">int</span> lmax_=0, <span class="keywordtype">int</span> mmax_=0)
00057       : lmax(lmax_), mmax(mmax_), tval(2*lmax+1),
00058         alm (Num_Alms(lmax,mmax))
00059       {}
00060 <span class="comment"></span>
00061 <span class="comment">    /*! Deletes the old coefficients and allocates storage according to</span>
00062 <span class="comment">        \a lmax and \a mmax. */</span>
<a name="l00063"></a><a class="code" href="classAlm.html#a1">00063</a>     <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a1">Set</a> (<span class="keywordtype">int</span> lmax_, <span class="keywordtype">int</span> mmax_)
00064       {
00065       lmax=lmax_;
00066       mmax=mmax_;
00067       tval=2*lmax+1;
00068       alm.alloc(<a class="code" href="classAlm.html#e0">Num_Alms</a>(lmax,mmax));
00069       }
00070 <span class="comment"></span>
00071 <span class="comment">    /*! Deallocates the old coefficients and uses the content of \a data</span>
00072 <span class="comment">        for storage. \a data is deallocated during the call. */</span>
<a name="l00073"></a><a class="code" href="classAlm.html#a2">00073</a>     <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a1">Set</a> (<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T&gt;</a> &amp;data, <span class="keywordtype">int</span> lmax_, <span class="keywordtype">int</span> mmax_)
00074       {
00075       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#a1">planck_assert</a> (<a class="code" href="classAlm.html#e0">Num_Alms</a>(lmax_,mmax_)==data.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a6">size</a>(),<span class="stringliteral">"wrong array size"</span>);
00076       lmax=lmax_;
00077       mmax=mmax_;
00078       tval=2*lmax+1;
00079       alm.transfer(data);
00080       }
00081 <span class="comment"></span>
00082 <span class="comment">    /*! Sets all coefficients to zero. */</span>
<a name="l00083"></a><a class="code" href="classAlm.html#a3">00083</a>     <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a3">SetToZero</a> ()
00084       { alm.fill (0); }
00085 <span class="comment"></span>
00086 <span class="comment">    /*! Multiplies all coefficients by \a factor. */</span>
<a name="l00087"></a><a class="code" href="classAlm.html#a4">00087</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a4">Scale</a> (<span class="keyword">const</span> T2 &amp;factor)
00088       { <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;alm.size(); ++m) alm[m]*=factor; }<span class="comment"></span>
00089 <span class="comment">    /*! \a a(l,m) *= \a factor[l] for all \a l,m. */</span>
<a name="l00090"></a><a class="code" href="classAlm.html#a5">00090</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a5">ScaleL</a> (<span class="keyword">const</span> <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T2&gt;</a> &amp;factor)
00091       {
00092       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#a1">planck_assert</a>(factor.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a6">size</a>()&gt;lmax, <span class="stringliteral">"alm.ScaleL: factor array too short"</span>);
00093       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;=mmax; ++m)
00094         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=m; l&lt;=lmax; ++l)
00095           <a class="code" href="classAlm.html#a7">operator()</a>(l,m)*=factor[l];
00096       }<span class="comment"></span>
00097 <span class="comment">    /*! Adds \a num to a_00. */</span>
<a name="l00098"></a><a class="code" href="classAlm.html#a6">00098</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a6">Add</a> (<span class="keyword">const</span> T2 &amp;num)
00099       { alm[0]+=num; }
00100 <span class="comment"></span>
00101 <span class="comment">    /*! Returns a reference to the specified coefficient. */</span>
<a name="l00102"></a><a class="code" href="classAlm.html#a7">00102</a>     T &amp;<a class="code" href="classAlm.html#a7">operator() </a>(<span class="keywordtype">int</span> l, <span class="keywordtype">int</span> m)
00103       { <span class="keywordflow">return</span> alm[((m*(tval-m))&gt;&gt;1) + l]; }<span class="comment"></span>
00104 <span class="comment">    /*! Returns a constant reference to the specified coefficient. */</span>
<a name="l00105"></a><a class="code" href="classAlm.html#a8">00105</a>     <span class="keyword">const</span> T &amp;<a class="code" href="classAlm.html#a7">operator() </a>(<span class="keywordtype">int</span> l, <span class="keywordtype">int</span> m)<span class="keyword"> const</span>
00106 <span class="keyword">      </span>{ <span class="keywordflow">return</span> alm[((m*(tval-m))&gt;&gt;1) + l]; }
00107 <span class="comment"></span>
00108 <span class="comment">    /*! Returns a pointer for a given m, from which the address of a_lm</span>
00109 <span class="comment">        can be obtained by adding l. */</span>
<a name="l00110"></a><a class="code" href="classAlm.html#a9">00110</a>     T *<a class="code" href="classAlm.html#a9">mstart</a> (<span class="keywordtype">int</span> m)
00111       { <span class="keywordflow">return</span> &amp;alm[(m*(tval-m))&gt;&gt;1]; }<span class="comment"></span>
00112 <span class="comment">    /*! Returns a pointer for a given m, from which the address of a_lm</span>
00113 <span class="comment">        can be obtained by adding l. */</span>
<a name="l00114"></a><a class="code" href="classAlm.html#a10">00114</a>     <span class="keyword">const</span> T *<a class="code" href="classAlm.html#a9">mstart</a> (<span class="keywordtype">int</span> m)<span class="keyword"> const</span>
00115 <span class="keyword">      </span>{ <span class="keywordflow">return</span> &amp;alm[(m*(tval-m))&gt;&gt;1]; }
00116 <span class="comment"></span>
00117 <span class="comment">    /*! Returns the maximum \a l */</span>
<a name="l00118"></a><a class="code" href="classAlm.html#a11">00118</a>     <span class="keywordtype">int</span> <a class="code" href="classAlm.html#a11">Lmax</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> lmax; }<span class="comment"></span>
00119 <span class="comment">    /*! Returns the maximum \a m */</span>
<a name="l00120"></a><a class="code" href="classAlm.html#a12">00120</a>     <span class="keywordtype">int</span> <a class="code" href="classAlm.html#a12">Mmax</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mmax; }
00121 <span class="comment"></span>
00122 <span class="comment">    /*! Returns a constant reference to the a_lm data. */</span>
<a name="l00123"></a><a class="code" href="classAlm.html#a13">00123</a>     <span class="keyword">const</span> <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T&gt;</a> &amp;<a class="code" href="classAlm.html#a13">Alms</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> alm; }
00124 <span class="comment"></span>
00125 <span class="comment">    /*! Swaps the contents of two A_lm objects. */</span>
<a name="l00126"></a><a class="code" href="classAlm.html#a14">00126</a>     <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a14">swap</a> (<a class="code" href="classAlm.html">Alm</a> &amp;other)
00127       {
00128       std::swap(lmax, other.<a class="code" href="classAlm.html#r0">lmax</a>);
00129       std::swap(mmax, other.<a class="code" href="classAlm.html#r1">mmax</a>);
00130       std::swap(tval, other.<a class="code" href="classAlm.html#r2">tval</a>);
00131       alm.swap(other.<a class="code" href="classAlm.html#r3">alm</a>);
00132       }
00133 <span class="comment"></span>
00134 <span class="comment">    /*! Returns \a true, if both objects have the same \a lmax and \a mmax,</span>
00135 <span class="comment">        else  \a false. */</span>
<a name="l00136"></a><a class="code" href="classAlm.html#a15">00136</a>     <span class="keywordtype">bool</span> <a class="code" href="classAlm.html#a15">conformable</a> (<span class="keyword">const</span> <a class="code" href="classAlm.html">Alm</a> &amp;other)<span class="keyword"> const</span>
00137 <span class="keyword">      </span>{ <span class="keywordflow">return</span> ((lmax==other.<a class="code" href="classAlm.html#r0">lmax</a>) &amp;&amp; (mmax==other.<a class="code" href="classAlm.html#r1">mmax</a>)); }
00138 <span class="comment"></span>
00139 <span class="comment">    /*! Adds all coefficients from \a other to the own coefficients. */</span>
<a name="l00140"></a><a class="code" href="classAlm.html#a16">00140</a>     <span class="keywordtype">void</span> <a class="code" href="classAlm.html#a6">Add</a> (<span class="keyword">const</span> <a class="code" href="classAlm.html">Alm</a> &amp;other)
00141       {
00142       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#a1">planck_assert</a> (<a class="code" href="classAlm.html#a15">conformable</a>(other), <span class="stringliteral">"A_lm are not conformable"</span>);
00143       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;alm.size(); ++m)
00144         alm[m] += other.<a class="code" href="classAlm.html#r3">alm</a>[m];
00145       }
00146   };
00147 
00148 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Thu Feb 19 17:23:18 2009 for Healpix C++
</a> </small></address>
</body>
</html>
