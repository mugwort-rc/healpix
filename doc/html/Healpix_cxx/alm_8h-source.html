<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Healpix C++: alm.h Source File</title>
<link href="sheet.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">Healpix_cxx</a></div>
<h1>alm.h</h1><a href="alm_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> *  This file is part of Healpix_cxx.</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  Healpix_cxx is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> *  (at your option) any later version.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> *  Healpix_cxx is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> *  GNU General Public License for more details.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> *  along with Healpix_cxx; if not, write to the Free Software</span>
00016 <span class="comment"> *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> *  For more information about HEALPix, see http://healpix.jpl.nasa.gov</span>
00019 <span class="comment"> */</span>
00020 
00021 <span class="comment">/*</span>
00022 <span class="comment"> *  Healpix_cxx is being developed at the Max-Planck-Institut fuer Astrophysik</span>
00023 <span class="comment"> *  and financially supported by the Deutsches Zentrum fuer Luft- und Raumfahrt</span>
00024 <span class="comment"> *  (DLR).</span>
00025 <span class="comment"> */</span>
00026 <span class="comment"></span>
00027 <span class="comment">/*! \file alm.h</span>
00028 <span class="comment"> *  Class for storing spherical harmonic coefficients.</span>
00029 <span class="comment"> *</span>
00030 <span class="comment"> *  Copyright (C) 2003, 2004, 2005 Max-Planck-Society</span>
00031 <span class="comment"> *  \author Martin Reinecke</span>
00032 <span class="comment"> */</span>
00033 
00034 <span class="preprocessor">#ifndef PLANCK_ALM_H</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define PLANCK_ALM_H</span>
00036 <span class="preprocessor"></span>
00037 <span class="preprocessor">#include "<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/arr_8h.html">arr.h</a>"</span>
00038 <span class="comment"></span>
00039 <span class="comment">/*! Class for storing spherical harmonic coefficients. */</span>
<a name="l00040"></a><a class="code" href="classAlm.html">00040</a> <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class </span><a class="code" href="classAlm.html">Alm</a>
00041   {
00042   <span class="keyword">private</span>:
00043     <span class="keywordtype">int</span> lmax, mmax, tval;
00044     <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T&gt;</a> alm;
00045 
00046   <span class="keyword">public</span>:<span class="comment"></span>
00047 <span class="comment">    /*! Constructs an Alm object with given \a lmax and \a mmax. */</span>
<a name="l00048"></a><a class="code" href="classAlm.html#a0">00048</a>     <a class="code" href="classAlm.html">Alm</a> (<span class="keywordtype">int</span> lmax_=0, <span class="keywordtype">int</span> mmax_=0)
00049       : lmax(lmax_), mmax(mmax_), tval(2*lmax+1),
00050         alm (((mmax+1)*(mmax+2))/2 + (mmax+1)*(lmax-mmax))
00051       { <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#gga1">planck_assert</a>(mmax&lt;=lmax,<span class="stringliteral">"mmax must not be larger than mmax"</span>); }
00052 <span class="comment"></span>
00053 <span class="comment">    /*! Deletes the old coefficients and allocates storage according to</span>
00054 <span class="comment">        \a lmax and \a mmax. */</span>
<a name="l00055"></a><a class="code" href="classAlm.html#a1">00055</a>     <span class="keywordtype">void</span> Set (<span class="keywordtype">int</span> lmax_, <span class="keywordtype">int</span> mmax_)
00056       {
00057       lmax=lmax_;
00058       mmax=mmax_;
00059       tval=2*lmax+1;
00060       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#gga1">planck_assert</a>(mmax&lt;=lmax,<span class="stringliteral">"mmax must not be larger than mmax"</span>);
00061       <span class="keywordtype">int</span> num_alms = ((mmax+1)*(mmax+2))/2 + (mmax+1)*(lmax-mmax);
00062       alm.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a6">alloc</a>(num_alms);
00063       }
00064 <span class="comment"></span>
00065 <span class="comment">    /*! Sets all coefficients to zero. */</span>
<a name="l00066"></a><a class="code" href="classAlm.html#a2">00066</a>     <span class="keywordtype">void</span> SetToZero ()
00067       { alm.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a8">fill</a> (0); }
00068 <span class="comment"></span>
00069 <span class="comment">    /*! Multiplies all coefficients by \a factor. */</span>
<a name="l00070"></a><a class="code" href="classAlm.html#a3">00070</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> Scale (<span class="keyword">const</span> T2 &amp;factor)
00071       { <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;alm.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a5">size</a>(); ++m) alm[m]*=factor; }<span class="comment"></span>
00072 <span class="comment">    /*! \a a(l,m) *= \a factor[l] for all \a l,m. */</span>
<a name="l00073"></a><a class="code" href="classAlm.html#a4">00073</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> ScaleL (<span class="keyword">const</span> <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T2&gt;</a> &amp;factor)
00074       {
00075       <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/group__assertgroup.html#gga1">planck_assert</a>(factor.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a5">size</a>()&gt;lmax, <span class="stringliteral">"alm.ScaleL: factor array too short"</span>);
00076       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;=mmax; ++m)
00077         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=m; l&lt;=lmax; ++l)
00078           operator()(l,m)*=factor[l];
00079       }<span class="comment"></span>
00080 <span class="comment">    /*! Adds \a num to a_00. */</span>
<a name="l00081"></a><a class="code" href="classAlm.html#a5">00081</a>     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T2&gt; <span class="keywordtype">void</span> Add (<span class="keyword">const</span> T2 &amp;num)
00082       { alm[0]+=num; }
00083 <span class="comment"></span>
00084 <span class="comment">    /*! Returns a reference to the specified coefficient. */</span>
<a name="l00085"></a><a class="code" href="classAlm.html#a6">00085</a>     T &amp;operator() (<span class="keywordtype">int</span> l, <span class="keywordtype">int</span> m)
00086       { <span class="keywordflow">return</span> alm[((m*(tval-m))&gt;&gt;1) + l]; }<span class="comment"></span>
00087 <span class="comment">    /*! Returns a constant reference to the specified coefficient. */</span>
<a name="l00088"></a><a class="code" href="classAlm.html#a7">00088</a>     <span class="keyword">const</span> T &amp;operator() (<span class="keywordtype">int</span> l, <span class="keywordtype">int</span> m)<span class="keyword"> const</span>
00089 <span class="keyword">      </span>{ <span class="keywordflow">return</span> alm[((m*(tval-m))&gt;&gt;1) + l]; }
00090 <span class="comment"></span>
00091 <span class="comment">    /*! Returns a pointer for a given m, from which the address of a_lm</span>
00092 <span class="comment">        can be obtained by adding l. */</span>
<a name="l00093"></a><a class="code" href="classAlm.html#a8">00093</a>     T *mstart (<span class="keywordtype">int</span> m)
00094       { <span class="keywordflow">return</span> &amp;alm[(m*(tval-m))&gt;&gt;1]; }<span class="comment"></span>
00095 <span class="comment">    /*! Returns a pointer for a given m, from which the address of a_lm</span>
00096 <span class="comment">        can be obtained by adding l. */</span>
<a name="l00097"></a><a class="code" href="classAlm.html#a9">00097</a>     <span class="keyword">const</span> T *mstart (<span class="keywordtype">int</span> m)<span class="keyword"> const</span>
00098 <span class="keyword">      </span>{ <span class="keywordflow">return</span> &amp;alm[(m*(tval-m))&gt;&gt;1]; }
00099 <span class="comment"></span>
00100 <span class="comment">    /*! Returns the maximum \a l */</span>
<a name="l00101"></a><a class="code" href="classAlm.html#a10">00101</a>     <span class="keywordtype">int</span> Lmax()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> lmax; }<span class="comment"></span>
00102 <span class="comment">    /*! Returns the maximum \a m */</span>
<a name="l00103"></a><a class="code" href="classAlm.html#a11">00103</a>     <span class="keywordtype">int</span> Mmax()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mmax; }
00104 <span class="comment"></span>
00105 <span class="comment">    /*! Returns a constant reference to the a_lm data. */</span>
<a name="l00106"></a><a class="code" href="classAlm.html#a12">00106</a>     <span class="keyword">const</span> <a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html">arr&lt;T&gt;</a> &amp;Alms ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> alm; }
00107 <span class="comment"></span>
00108 <span class="comment">    /*! Swaps the contents of two A_lm objects. */</span>
<a name="l00109"></a><a class="code" href="classAlm.html#a13">00109</a>     <span class="keywordtype">void</span> swap (<a class="code" href="classAlm.html">Alm</a> &amp;other)
00110       {
00111       std::swap(lmax, other.<a class="code" href="classAlm.html#r0">lmax</a>);
00112       std::swap(mmax, other.<a class="code" href="classAlm.html#r1">mmax</a>);
00113       std::swap(tval, other.<a class="code" href="classAlm.html#r2">tval</a>);
00114       alm.<a class="codeRef" doxygen="cxxsupport.tag:../cxxsupport/" href="../cxxsupport/classarr.html#a21">swap</a>(other.<a class="code" href="classAlm.html#r3">alm</a>);
00115       }
00116 <span class="comment"></span>
00117 <span class="comment">    /*! Returns \a true, if both objects have the same \a lmax and \a mmax,</span>
00118 <span class="comment">        else  \a false. */</span>
<a name="l00119"></a><a class="code" href="classAlm.html#a14">00119</a>     <span class="keywordtype">bool</span> conformable (<span class="keyword">const</span> <a class="code" href="classAlm.html">Alm</a> &amp;other)<span class="keyword"> const</span>
00120 <span class="keyword">      </span>{ <span class="keywordflow">return</span> ((lmax==other.<a class="code" href="classAlm.html#r0">lmax</a>) &amp;&amp; (mmax==other.<a class="code" href="classAlm.html#r1">mmax</a>)); }
00121   };
00122 
00123 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Fri Jul 8 09:37:15 2005 for Healpix C++
</a> </small></address>
</body>
</html>
