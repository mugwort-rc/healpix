<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Bug Correction in synfast 2.14</TITLE>
<META NAME="description" CONTENT="Bug Correction in synfast 2.14">
<META NAME="keywords" CONTENT="facilities">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="facilities.css">

<LINK REL="previous" HREF="facilitiesnode16.htm">
<LINK REL="up" HREF="facilitiesnode16.htm">
<LINK REL="next" HREF="facilitiesnode18.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html236"
  HREF="facilitiesnode16.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html240"
  HREF="facilitiesnode16.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html244"
  HREF="facilitiesnode18.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html242"
  HREF="facilitiesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html237"
  HREF="facilitiesnode16.htm">Appendix</A>

<B>Up:</B> <A NAME="tex2html241"
  HREF="facilitiesnode16.htm">Appendix</A>

<B> Next:</B> <A NAME="tex2html245"
  HREF="facilitiesnode18.htm">About this document ...</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000161000000000000000"></A>
<A NAME="sec:bug_synder"></A>
<BR>
Bug Correction in synfast 2.14
</H2>
Thanks to the routine <TT>alm2map_der</TT>, the Fortran90 <TT>synfast</TT> facility  produces
maps of <SPAN CLASS="MATH"><I>I</I>,<I>Q</I>,<I>U</I></SPAN> Stokes parameters and their first and second spatial derivatives,
starting from <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> or <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients.
<B>A bug affecting the calculation of <!-- MATH
 $\partial X/\partial\theta$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="60" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg1.png"
 ALT="$\partial X/\partial\theta$"></SPAN>, 
<!-- MATH
 $\partial^2 X/\partial \theta^2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="76" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg3.png"
 ALT="$\partial^2 X/\partial \theta^2$"></SPAN>, 
<!-- MATH
 $\partial^2 X/(\partial\theta\partial\varphi\sin(\theta))$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="156" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg52.png"
 ALT="$\partial^2 X/(\partial\theta\partial\varphi\sin(\theta))$"></SPAN>, for <SPAN CLASS="MATH"><I>X</I>=(<I>Q</I>,<I>U</I>)</SPAN>
was detected in this routine and has been fixed in release 2.14 (March 2010).</B>

<P>
In what follows, the impact of this bug on the power spectra of
the produced maps is quantified, so that users can
assess how much their work could have been affected by this bug.

<P>

<DIV ALIGN="CENTER"><A NAME="fig:bug_derQU"></A><A NAME="2716"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 1:</STRONG>
Left panels: comparison of the EE power spectra <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> computed on polarized maps
derivatives generated by
<TT>synfast</TT>-2.13a (Old maps, blue bashes), the bug corrected <TT>synfast</TT>-2.14 (New maps, black lines)
and their differences (Diff maps, magenta lines). Note that what is plotted is
<SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN>, <EM>not</EM> the customary <!-- MATH
 $l(l+1)C(l)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="129" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg53.png"
 ALT="$l(l+1)C(l)/2\pi$"></SPAN>. Right panels show respectively
the relative error on the EE power spectrum of the old derivatives maps compared
to that of the new maps.
The red dashes show analytical fit to these errors.
</CAPTION>
<TR><TD>
<DIV CLASS="centerline" ID="par4731" ALIGN="CENTER">
<IMG
  WIDTH="720" HEIGHT="533" ALIGN="BOTTOM" BORDER="0"
 SRC="IGimg1.png"
 ALT="Image error_der"></DIV>

<P></TD></TR>
</TABLE>
</DIV>
In Figure&nbsp;<A HREF="#fig:bug_derQU">1</A> we show the polarization <SPAN CLASS="MATH"><I>EE</I></SPAN> power spectrum of
<!-- MATH
 $N_{\rm side} = 1024$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="106" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg54.png"
 ALT="$N_{\rm side} = 1024$"></SPAN> maps
in which the Stokes parameters <SPAN CLASS="MATH">(<I>Q</I>,<I>U</I>)</SPAN> have been replaced by, in turn, their derivatives
<!-- MATH
 $\partial (Q,U)/\partial\theta$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="97" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg55.png"
 ALT="$\partial (Q,U)/\partial\theta$"></SPAN>, 
<!-- MATH
 $\partial^2 (Q,U)/\partial \theta^2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="113" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg56.png"
 ALT="$\partial^2 (Q,U)/\partial \theta^2$"></SPAN>, 
<!-- MATH
 $\partial^2 (Q,U)/(\partial\theta\partial\varphi\sin\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="181" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg57.png"
 ALT="$\partial^2 (Q,U)/(\partial\theta\partial\varphi\sin\theta)$"></SPAN>, 
for maps generated
by either the version 2.13a of <TT>synfast</TT> or the corrected version 2.14, or
the difference of the two set of maps.
The input power spectra were those of WMAP-1yr <SPAN CLASS="MATH"><IMG
 WIDTH="18" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg58.png"
 ALT="$\Lambda$"></SPAN>-CDM best fit model with a Gaussian
beam FWHM of 10 arcmin. The power spectra were computed on the whole maps, except
for 12 pixels around each pole that were masked out, because they get very
bright in second order derivatives.

<P>
It can be seen that the relative effect of the computation error on the produced maps was
large at low <SPAN CLASS="MATH"><I>l</I></SPAN>, at scales on which derivatives maps contain little power, but decreasing
steadily with <SPAN CLASS="MATH"><I>l</I></SPAN>.

<P>
It should be stressed that the following quantities were <EM>not</EM> affected by
the bug described above:
<DL COMPACT><DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the Stokes parameters themselves <SPAN CLASS="MATH">(<I>I</I>,<I>Q</I>,<I>U</I>)</SPAN>,
<DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the intensity <SPAN CLASS="MATH"><I>I</I></SPAN> and all its derivatives,
<DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="greenball.png" ALT="*">
 the Laplacians <!-- MATH
 $\Delta I, \Delta Q$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="69" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg59.png"
 ALT="$\Delta I, \Delta Q$"></SPAN> and <SPAN CLASS="MATH"><IMG
 WIDTH="35" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg60.png"
 ALT="$\Delta U$"></SPAN>, with
<!-- MATH
 $\Delta \equiv \left(
\frac{\partial^2}{\partial\theta^2}
+ \cot\theta\frac{\partial}{\partial\theta} + 
\frac{\partial^2}{\sin^2\theta\partial\varphi^2} 
\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="251" HEIGHT="47" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg61.png"
 ALT="$\Delta \equiv \left(
\frac{\partial^2}{\partial\theta^2}
+ \cot\theta\frac{\partial}{\partial\theta} +
\frac{\partial^2}{\sin^2\theta\partial\varphi^2}
\right)$"></SPAN>.
</DL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html236"
  HREF="facilitiesnode16.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html240"
  HREF="facilitiesnode16.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html244"
  HREF="facilitiesnode18.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html242"
  HREF="facilitiesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html237"
  HREF="facilitiesnode16.htm">Appendix</A>

<B>Up:</B> <A NAME="tex2html241"
  HREF="facilitiesnode16.htm">Appendix</A>

<B> Next:</B> <A NAME="tex2html245"
  HREF="facilitiesnode18.htm">About this document ...</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Eric Hivon
2010-06-18
</ADDRESS>
</BODY>
</HTML>
