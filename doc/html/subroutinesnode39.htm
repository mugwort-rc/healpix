<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>map2alm*</TITLE>
<META NAME="description" CONTENT="map2alm*">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="subroutinesnode40.htm">
<LINK REL="previous" HREF="subroutinesnode38.htm">
<LINK REL="up" HREF="subroutines.htm">
<LINK REL="next" HREF="subroutinesnode40.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html657"
  HREF="subroutinesnode38.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html663"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html667"
  HREF="subroutinesnode40.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html665"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html658"
  HREF="subroutinesnode38.htm">input_tod*</A>

<B>Up:</B> <A NAME="tex2html664"
  HREF="subroutines.htm">Healpix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html668"
  HREF="subroutinesnode40.htm">medfiltmap*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000390000000000000000"></A>
<A NAME="sub:map2alm"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">map2alm*</FONT></font></b><hr><H2>This routine is a wrapper to 5 other routines:map2alm_sc,
map2alm_sc_pre, map2alm_pol, map2alm_pol_pre1,
map2alm_pol_pre2. These routines analyse a <b>HEALPix</b> map and return
<SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>T</I></SUP></SPAN> (and if specified <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>E</I></SUP></SPAN> and <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>B</I></SUP></SPAN>) values up to
the desired order in <SPAN CLASS="MATH"><I>l</I></SPAN> (maximum 3*<SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN>). The different
routines are called dependent on what parameters are passed. Some
routines analyse with or without precomputed harmonics and some with
or without polarisation. </H2><br>Location in HEALPix directory tree: <b>
src/f90/mod/alm_tools.f90
</b>

<P>
<hr><h1>FORMAT </h1><blockquote><h2>call <FONT COLOR="#CC0000">map2alm*</FONT>(
nsmax, nlmax, nmmax, map_TQU, alm_TGC, zbounds, w8ring_TQU [, plm]
)</h2></blockquote>

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">name&nbsp;&amp;&nbsp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>
nsmax</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> value of the map to analyse.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>nlmax</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>l</I></SPAN> value for the analysis.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>nmmax</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>m</I></SPAN> value for the analysis.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>map_TQU(0:12*nsmax**2-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>if only the temperature map is to be analyse, the map-array should be passed with this rank.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>map_TQU(0:12*nsmax**2-1, 1:3)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>if both temperature an polarisation maps are to be analysed, the map array should have this rank, where the second index is (1,2,3) corresponding to (T,Q,U).</TD>
</TR>
</TABLE>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>alm_TGC(1:p, 0:nlmax, 0:nmmax)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SPC/ DPC</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>The <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> values output from the analysis. p is 1 or 3 dependent on wether polarisation is included or not. In the former case, the first index is (1,2,3) corresponding to (T,E,B).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>zbounds(1:2)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>section of the map on which to perform the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>
                   analysis, expressed in terms of <!-- MATH
 $z=\sin({\rm latitude}) =
                   \cos(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="203" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg63.png"
 ALT="$z=\sin({\rm latitude}) =
\cos(\theta)$"></SPAN>. If zbounds(1)<SPAN CLASS="MATH">&lt;</SPAN>zbounds(2), the analysis is
                   performed <EM>on</EM> the strip zbounds(1)<SPAN CLASS="MATH">&lt;<I>z</I>&lt;</SPAN>zbounds(2); if not,
                   it is performed <EM>outside</EM> of the strip
                   zbounds(2)<SPAN CLASS="MATH">&lt;<I>z</I>&lt;</SPAN>zbounds(1).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>w8ring_TQU(1:2*nsmax, 1:p)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>ring weights for quadrature corrections. If ring weights are not used, this array should be 1 everywhere. p is 1 for a temperature analysis and 3 for (T,Q,U).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>plm(0:(nlmax+1)*(nlmax+2)*nsmax-1), OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional matrix is passed with this rank, precomputed <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="55" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg14.png"
 ALT="$P_{lm}(\theta)$"></SPAN> are used instead of recursion.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>plm(0:(nlmax+1)*(nlmax+2)*nsmax-1, 1:3), OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional matrix is passed with this rank, precomputed <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="55" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg14.png"
 ALT="$P_{lm}(\theta)$"></SPAN> AND precomputed tensor harmonics are used instead of recursion.</TD>
</TR>
</TABLE>

<P>
<HR><H1>EXAMPLE:</H1><tt><FONT SIZE=+1>
real(dp), allocatable, dimension(:,:) :: dw8 
<BR>
allocate(dw8(1:512,1:3)) 
<BR>
dw8 = 1.0_dp 
<BR>
z = sin(10.0_dp * PI/180.0_dp) 
<BR>
call map2alm(256, 512, 512, map(0:12*256**2-1,1:3),
alm(1:3,0:512,0:512), (<SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg10.png"
 ALT="$\backslash$"></SPAN> z, -z <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg10.png"
 ALT="$\backslash$"></SPAN>) , dw8, plm(0:513*514*256-1)  
<BR></font></tt>
<BR><blockquote>
Analyses temperature and polarisation maps passed in map. The map has
an <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> of 256, an the analyses is supposed to be performed up
to 512 in <SPAN CLASS="MATH"><I>l</I></SPAN> and m. The resulting <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coeffecients for
temperature and polarisation are returned in alm. A <SPAN CLASS="MATH"><IMG
 WIDTH="32" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg64.png"
 ALT="$10^\circ$"></SPAN> cut on
each side of the equator is applied. Uniform weights are used. Since
the optional plm array is passed, precomputed <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="55" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg14.png"
 ALT="$P_{lm}(\theta)$"></SPAN> are
used, but only scalar ones because of the rank of the array. The
tensor harmonics are still computed with a recursion.
</blockquote>

<P>
<hr><H1>MODULES & ROUTINES</H1><H2>This section lists the modules and routines used by <FONT COLOR="#CC0000">map2alm*</FONT>.</h2>
  <DL COMPACT><DT>
<B>ring_analysis</B>
<DD>Performs FFT for the ring analysis.
  <DT>
<B><SPAN  CLASS="textbf">misc_util</SPAN></B>
<DD>module, containing:
  <DT>
<B>assert_alloc</B>
<DD>routine to print error message when an array is not
  properly allocated		
  </DL>

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">map2alm*</FONT></b></h3>
<BR> 
  <DL COMPACT><DT>
<B>anafast</B>
<DD>executable using <FONT COLOR="#CC0000">map2alm*</FONT>to analyse maps.
  <DT>
<B><A HREF="subroutinesnode9.htm#sub:alm2map">alm2map</A></B>
<DD>routine performing the inverse transform of <FONT COLOR="#CC0000">map2alm*</FONT>.
  </DL>

<P>

<P>


<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html657"
  HREF="subroutinesnode38.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html663"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html667"
  HREF="subroutinesnode40.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html665"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html658"
  HREF="subroutinesnode38.htm">input_tod*</A>

<B>Up:</B> <A NAME="tex2html664"
  HREF="subroutines.htm">Healpix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html668"
  HREF="subroutinesnode40.htm">medfiltmap*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Eric Hivon
2005-08-31
</ADDRESS>
</BODY>
</HTML>
