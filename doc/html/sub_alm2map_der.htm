<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">

<!--Converted with LaTeX2HTML 2018.3 (Released July 19, 2018) -->
<HTML lang="EN">
<HEAD>
<TITLE>alm2map_der*</TITLE>
<META NAME="description" CONTENT="alm2map_der*">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.3">
   <link rel='apple-touch-icon' sizes='180x180' href='images/favicons/apple-touch-icon.png?v=2017'>
   <link rel='icon' type='image/png' sizes='32x32' href='images/favicons/favicon-32x32.png?v=2017'>
   <link rel='icon' type='image/png' sizes='16x16' href='images/favicons/favicon-16x16.png?v=2017'>
   <link rel='manifest' href='images/favicons/manifest.json?v=2017'>
   <link rel='mask-icon' href='images/favicons/safari-pinned-tab.svg?v=2017' color='#5bbad5'>
   <link rel='shortcut icon' href='images/favicons/favicon.ico?v=2017'>
   <meta name='apple-mobile-web-app-title' content='HEALPix'>
   <meta name='application-name' content='HEALPix'>
   <meta name='msapplication-config' content='images/favicons/browserconfig.xml?v=2017'>
   <meta name='theme-color' content='#ffffff'>

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="sub_alm2map_spin.htm">
<LINK REL="previous" HREF="sub_alm2map.htm">
<LINK REL="next" HREF="sub_alm2map_spin.htm">
</HEAD>

<body text="#000000" bgcolor="#FFFFFA">

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="sub_alm2map.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="sub_HEALPix_F90_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="sub_alm2map_spin.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html310"
  HREF="sub_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A
 HREF="sub_alm2map.htm">alm2map*</A>

<B>Up:</B> <A
 HREF="sub_HEALPix_F90_subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A
 HREF="sub_alm2map_spin.htm">alm2map_spin*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION900"></A>
<A ID="sub:alm2map_der"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">alm2map_der*</FONT></font></b><hr>
<H3>This routine is a wrapper to four other routines that synthesize a <b>HEALPix</b> 
  temperature (and polarisation) map(s), its (their) first derivatives, and optionally
  its (their) second derivatives.
The routines accept both single and double precision arrays for alm, map, der1 and
der2. The precision of these arrays should match. All maps produced are RING
ordered.
<br><br>See <A ID="tex2html17"
  HREF="facilities.htm">&rdquo;Fortran
Facilities&rdquo;</A>
<A HREF="./fac_Appendix.htm#fac:sec:bug_synder">Appendix</A> for a note on a bug
affecting the calculation of polarisation derivatives on past versions of this routine.
</H3>
Location in HEALPix directory tree: <a href="https://sourceforge.net/p/healpix/code/1005/tree/trunk/src/f90/mod/alm_tools.F90"><b>src/f90/mod/alm_tools.F90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>call <FONT COLOR="#CC0000">alm2map_der*</FONT>(
<A HREF="#sub:alm2map_der:nsmax">nsmax</A>, <A HREF="#sub:alm2map_der:nlmax">nlmax</A>, <A HREF="#sub:alm2map_der:nmmax">nmmax</A>, <A HREF="#sub:alm2map_der:alm">alm</A>, <A HREF="#sub:alm2map_der:map">map</A>, <A HREF="#sub:alm2map_der:der1">der1</A>[, <A HREF="#sub:alm2map_der:der2">der2</A>=, <A HREF="#sub:alm2map_der:zbounds">zbounds</A>=]
)</h3></blockquote>

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SPAN  CLASS="textbf">name&nbsp;&amp;&nbsp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>
nsmax<A ID="sub:alm2map_der:nsmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the <!-- MATH
 $N_{\mathrm{side}}$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>side</SUB></SPAN> value of the map to synthesize.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>nlmax<A ID="sub:alm2map_der:nlmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><IMG STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="sub_img21.png"
 ALT="$\ell$"></SPAN> value used for the <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>nmmax<A ID="sub:alm2map_der:nmmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>m</I></SPAN> value used for the <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>alm<A ID="sub:alm2map_der:alm"></A>(1:p, 0:nlmax, 0:nmmax)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SPC/ DPC</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>The <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN> values to make the map
                   from. p is either 1 (temperature only) or 3 (temperature+polarisation).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>map<A ID="sub:alm2map_der:map"></A>(0:12*nsmax**2-1) <EM>or  </EM>(0:12*nsmax**2-1,1:3)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>temperature
map <SPAN CLASS="MATH"><I>T</I>(<I>p</I>)</SPAN> or temperature + polarisation maps <SPAN CLASS="MATH"><I>T</I>(<I>p</I>)</SPAN>, <SPAN CLASS="MATH"><I>Q</I>(<I>p</I>)</SPAN>, <SPAN CLASS="MATH"><I>U</I>(<I>p</I>)</SPAN> to be synthesized.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>der1<A ID="sub:alm2map_der:der1"></A>(0:12*nsmax**2-1, 1:2*p)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>contains on output the first
derivatives of T: <!-- MATH
 $\left({\partial T}/{\partial \theta}, {\partial T}/{\partial \phi}/\sin\theta \right)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="sub_img46.png"
 ALT="$\left({\partial T}/{\partial \theta}, {\partial T}/{\partial \phi}/\sin\theta \right)
$"></SPAN> or the interleaved derivatives of T, Q, and U: <!-- MATH
 $\left({\partial T}/{\partial
  \theta}, {\partial Q}/{\partial \theta}, {\partial U}/{\partial \theta};\right.$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="sub_img47.png"
 ALT="$\left({\partial T}/{\partial
\theta}, {\partial Q}/{\partial \theta}, {\partial U}/{\partial \theta};\right. $"></SPAN>
<!-- MATH
 $\left.{\partial T}/{\partial \phi}/\sin\theta, \ldots \right)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="sub_img48.png"
 ALT="$\left.{\partial T}/{\partial \phi}/\sin\theta, \ldots \right)
$"></SPAN></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>der2<A ID="sub:alm2map_der:der2"></A>(0:12*nsmax**2-1,1:3*p), OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional
matrix is passed with this rank, it will contain on output the second derivatives
<!-- MATH
 $\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 T}/{\partial
  \theta\partial\phi}/\sin\theta,\right.$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="sub_img49.png"
 ALT="$\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 T}/{\partial
\theta\partial\phi}/\sin\theta,\right. $"></SPAN> 
<!-- MATH
 $\left.{\partial^2 T}/{\partial \phi^2}/\sin^2\theta \right)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="sub_img50.png"
 ALT="$\left.{\partial^2 T}/{\partial \phi^2}/\sin^2\theta \right) $"></SPAN> or
<!-- MATH
 $\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 Q}/{\partial \theta^2},
{\partial^2 Q}/{\partial \theta^2}, \ldots \right)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.68ex; " SRC="sub_img51.png"
 ALT="$\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 Q}/{\partial \theta^2},
{\partial^2 Q}/{\partial \theta^2}, \ldots \right) $"></SPAN></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>zbounds<A ID="sub:alm2map_der:zbounds"></A>(1:2), OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>section of the sphere on which to perform the map synthesis, expressed in terms of <!-- MATH
 $z=\sin(\mathrm{latitude}) = \cos(\theta).$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="sub_img42.png"
 ALT="$z=\sin(\mathrm{latitude}) =
\cos(\theta).$"></SPAN> If zbounds(1)<SPAN CLASS="MATH">&lt;</SPAN>zbounds(2), it is
performed <EM>on</EM> the strip zbounds(1)<SPAN CLASS="MATH">&lt;<I>z</I>&lt;</SPAN>zbounds(2); if not,
it is performed <EM>outside</EM> the strip
zbounds(2)<SPAN CLASS="MATH"><IMG STYLE="height: 1.87ex; vertical-align: -0.41ex; " SRC="sub_img43.png"
 ALT="$\le z \le$"></SPAN>zbounds(1). If absent, the whole map is processed.

<P></TD>
</TR>
</TABLE>

<P>
<HR><H1>EXAMPLE:</H1> 
<tt>use healpix_types 
<BR>
use pix_tools, only : nside2npix 
<BR>
use alm_tools, only : alm2map_der 
<BR>
integer(I4B) :: nside, lmax, mmax, npix 
<BR>
real(SP), dimension(:), allocatable :: map 
<BR>
real(SP), dimension(:,:), allocatable :: der1, der2 
<BR>
complex(SPC), dimension(:,:,:), allocatable :: alm 
<BR>...
<BR>
nside=256 ; lmax=512 ; mmax=lmax
<BR>
npix=nside2npix(nside)
<BR>
allocate(alm(1:1,0:lmax,0:mmax))
<BR>
allocate(map(0:npix-1))
<BR>
allocate(der1(0:npix-1,1:2), der2(0:npix-1,1:3))
<BR>...
<BR>
call alm2map_der(nside, lmax, mmax, alm, map, der1, der2=der2)  
<BR></tt>
<blockquote>
Make temperature maps and its derivatives from the <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN> passed in alm. The maps have <!-- MATH
 $N_{\mathrm{side}}$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>side</SUB></SPAN> of 256, and are constructed from <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN> values up to 512 in <SPAN CLASS="MATH"><IMG STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="sub_img21.png"
 ALT="$\ell$"></SPAN> and <SPAN CLASS="MATH"><I>m</I></SPAN>.
</blockquote>

<P>
<hr><H1>MODULES & ROUTINES</H1><H3>This section lists the modules and routines used by <FONT COLOR="#CC0000">alm2map_der*</FONT>.</h3>
  <DL COMPACT><DT>
<B><A HREF="sub_ring_synthesis.htm#sub:ring_synthesis">ring_synthesis</A></B>
<DD>Performs FFT over <SPAN CLASS="MATH"><I>m</I></SPAN> for synthesis of the rings.
  <DT>
<B>compute_lam_mm, get_pixel_layout, </B>
<DD><DT>
<B>gen_lamfac_der, gen_mfac,  </B>
<DD><DT>
<B>gen_recfac, init_rescale, l_min_ylm</B>
<DD>Ancillary routines used
  for <!-- MATH
 $\ {_s}Y_{\ell m}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.04ex; vertical-align: -0.45ex; " SRC="sub_img52.png"
 ALT="$\ {_s}Y_{\ell m}$"></SPAN> recursion
  <DT>
<B><SPAN  CLASS="textbf">misc_utils</SPAN></B>
<DD>module, containing:
  <DT>
<B><A HREF="sub_assert_assert_alloc_assert_.htm#sub:assert">assert_alloc</A></B>
<DD>routine to print error message, when an array can not be
  allocated properly
  </DL>

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">alm2map_der*</FONT></b></h3>
 
  <DL COMPACT><DT>
<B><A HREF="sub_alm2map.htm#sub:alm2map">alm2map</A></B>
<DD>routine generating maps of temperature
   and polarisation from their  <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN>
   <DT>
<B><A HREF="sub_alm2map_spin.htm#sub:alm2map_spin">alm2map_spin</A></B>
<DD>routine generating maps of
arbitrary spin from their  <!-- MATH
 ${_s}a_{\ell m}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img45.png"
 ALT="${_s}a_{\ell m}$"></SPAN>
<DT>
<B>synfast</B>
<DD>executable using <FONT COLOR="#CC0000">alm2map_der*</FONT> to synthesize maps.
<DT>
<B><A HREF="sub_create_alm.htm#sub:create_alm">create_alm</A></B>
<DD>routine to generate randomly
  distributed <SPAN CLASS="MATH"><IMG STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="sub_img6.png"
 ALT="$a_{\ell m}$"></SPAN> coefficients according to a given power spectrum
  </DL>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="sub_alm2map.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="sub_HEALPix_F90_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="sub_alm2map_spin.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html310"
  HREF="sub_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A
 HREF="sub_alm2map.htm">alm2map*</A>

<B>Up:</B> <A
 HREF="sub_HEALPix_F90_subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A
 HREF="sub_alm2map_spin.htm">alm2map_spin*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.50, 2018-12-10
</ADDRESS>
</BODY>
</HTML>
