<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>smoothing</TITLE>
<META NAME="description" CONTENT="smoothing">
<META NAME="keywords" CONTENT="facilities">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="facilities.css">

<LINK REL="next" HREF="fac_synfast.htm">
<LINK REL="previous" HREF="fac_sky_ng_sim.htm">
<LINK REL="up" HREF="fac_HEALPix_F90_facilities.htm">
<LINK REL="next" HREF="fac_synfast.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html254"
  HREF="fac_sky_ng_sim.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html260"
  HREF="fac_HEALPix_F90_facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html264"
  HREF="fac_synfast.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html262"
  HREF="fac_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html255"
  HREF="fac_sky_ng_sim.htm">sky_ng_sim</A>

<B>Up:</B> <A NAME="tex2html261"
  HREF="fac_HEALPix_F90_facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A NAME="tex2html265"
  HREF="fac_synfast.htm">synfast</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION1300"></A>
<A NAME="fac:smoothing"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">smoothing</FONT></font></b><hr>
<H3>This program can be used to convolve a map with a gaussian beam. 
The input map can be given in RING or NESTED scheme and the smoothed map 
is written 
to a FITS file in the RING scheme.
<BR>
NOTE: This automated facility is susceptible to problems with non-commutativity
of discrete spherical harmonics transforms, described in the Recommendations
for Users of the <A HREF="fac_anafast.htm#fac:anafast">anafast</A> facility. 
If very high accuracy of the results is
required in the spectral regime of <!-- MATH
 $l> 2\cdot nsmax$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="103" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="fac_img52.png"
 ALT="$l&gt; 2\cdot nsmax$"></SPAN>, it is recommended
to choose an iterative computation of the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients.
</H3>
Location in HEALPix directory tree: <a href="https://sourceforge.net/p/healpix/code/945/tree/trunk/src/f90/smoothing/smoothing.f90"><b>src/f90/smoothing/smoothing.f90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>%
smoothing [options] [parameter_file]
</h3></blockquote>

<P>
<hr><H1>COMMAND LINE OPTIONS</H1> 
  <DL COMPACT><DT>
<B><TT>-d</TT></B>
<DD><DT>
<B><TT>--double</TT></B>
<DD>double precision mode (see 
  <A HREF="fac_Using_HEALPix_Fortran_90_fa.htm#fac:subsec:ioprec">Notes on double/single precision modes</A>)
    <DT>
<B><TT>-s</TT></B>
<DD><DT>
<B><TT>--single</TT></B>
<DD>single precision mode (default)
  </DL>

<P>
<hr>
<H1>QUALIFIERS</H1>
 
  <DL COMPACT><DT>
<B>simul_type = </B>
<DD><A NAME="fac:smoothing:simul_type"></A>Defines which map(s) to analyse, 1=temperature only, 2=temperature AND polarisation.
(default= 1)
    <DT>
<B>infile = </B>
<DD><A NAME="fac:smoothing:infile"></A>Defines the filename for the FITS file containing the map to be smoothed. 
	(default= 'map.fits')
    <DT>
<B>nlmax = </B>
<DD><A NAME="fac:smoothing:nlmax"></A>Defines the <!-- MATH
 $l_{\mathrm{max}}$
 -->
<SPAN CLASS="MATH"><I>l</I><SUB>max</SUB></SPAN> value for the application.
(default= 64)
    <DT>
<B>iter_order = </B>
<DD><A NAME="fac:smoothing:iter_order"></A>Defines the maximum order of quadrature 
      iteration to be used. (default=0, no iteration).
For details, see the <A HREF="./sub_map2alm_iterative.htm#sub:map2alm_iterative"><TT>map2alm_iterative</TT></A> routine
described in the <A NAME="tex2html20"
  HREF="subroutines.htm">''Fortran Subroutines''</A>
document.
 <DT>
<B>fwhm_arcmin = </B>
<DD><A NAME="fac:smoothing:fwhm_arcmin"></A>Defines the FWHM in arcminutes of the gaussian 
beam for the convolution. (default=10)
    <DT>
<B>beam_file = </B>
<DD>Defines the FITS file describing the
    Legendre window
    function of the circular beam to be used for the
    simulation (see <A HREF="fac_Using_HEALPix_Fortran_90_fa.htm#fac:subsec:beamfiles">''Beam window function files'' in introduction</A>). 
    If set to an existing file name, it will override the
    <TT>fhwm_arcmin</TT> given above. default=`'
<DT>
<B>outfile = </B>
<DD><A NAME="fac:smoothing:outfile"></A>Defines the filename for the file that will contain 
the smoothed map. (default='map_smoothed.fits')
     <DT>
<B>plmfile = </B>
<DD>Defines the name for an input file
    containing  precomputed Legendre polynomials <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN>.
(default= no entry -- <FONT COLOR="#CC0000">smoothing</FONT>executes the recursive evaluation 
of <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN>s)
<DT>
<B>w8file = </B>
<DD><A NAME="fac:smoothing:w8file"></A>Defines name for an input file containing ring
  weights in the improved quadrature mode (default= no entry --
the name is assumed to be 'weight_ring_n0xxxx.fits' where xxxx is nsmax)
<DT>
<B>w8filedir = </B>
<DD><A NAME="fac:smoothing:w8filedir"></A>Gives the directory where the weight files are
to be found (default= no entry -- smoothing searches in the default
directories, see <A HREF="fac_Using_HEALPix_Fortran_90_fa.htm#fac:subsec:defdir">''Default file names and directories'' in introduction</A>)
<DT>
<B>won = </B>
<DD><A NAME="fac:smoothing:won"></A>Set this to 1 if ring-based quadrature weight files are to be used,
 or to 2 to use pixel-based weight files instead;
otherwise set it to 0. (default= 0)
  </DL>

<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>

A FITS file containing a <b>HEALPix</b> map in RING or NESTED scheme is read in.
When dealing with polarized signal maps, the <FONT COLOR="#CC0000">smoothing</FONT> behavior will depend on the value of the <TT>POLCCONV</TT> FITS keyword
(see <A HREF="./intro_HEALPix_conventions.htm#intro:polcconv">note on POLCCONV</A> in <A NAME="tex2html21"
  HREF="intro.htm">The <b>HEALPix</b> Primer</A>).
The map is analysed and smoothed in fourier space with a  gaussian beam 
of a given FHWM. 
A new map is then synthesized using the smoothed <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients. 
For a more accurate application, an iteration of arbitrary order can be applied. 
The output map is stored in <EM>the same scheme</EM> as the input map.

</blockquote>

<P>
<hr><H1>DATASETS</H1>
<h3>The following datasets are involved in the <b><FONT COLOR="#CC0000">smoothing</FONT></b>
 processing.</h3>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SPAN  CLASS="textbf">Dataset</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SPAN  CLASS="textbf">Description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>
data/weight_ring_n0xxxx.fits</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>Files containing ring weights
                   for the smoothing improved quadrature mode.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
</TABLE>

<P>
<hr><H1>SUPPORT    </H1><H3>This section lists those routines and facilities (including those <i>external</i> to the <b>HEALPix</b> distribution) which can assist in the utilisation of <b><FONT COLOR="#CC0000">smoothing</FONT></b>.</H3>
  <DL COMPACT><DT>
<B><A HREF="./sub_generate_beam.htm#sub:generate_beam">generate_beam</A></B>
<DD>This <b>HEALPix</b> Fortran
subroutine generates or reads the <SPAN CLASS="MATH"><I>B</I>(<I>l</I>)</SPAN> window function used in <FONT COLOR="#CC0000">smoothing</FONT>
  <DT>
<B><A HREF="fac_map2gif.htm#fac:map2gif">map2gif</A></B>
<DD>This <b>HEALPix</b> Fortran facility can be used to visualise the
  input and output maps of <FONT COLOR="#CC0000">smoothing</FONT>.
  <DT>
<B><A HREF="./idl_mollview.htm#idl:mollview">mollview</A></B>
<DD>This <b>HEALPix</b> IDL facility can be used to visualise the
  input and output maps of <FONT COLOR="#CC0000">smoothing</FONT>.
  <DT>
<B><A HREF="fac_synfast.htm#fac:synfast">synfast</A></B>
<DD>This <b>HEALPix</b> facility can generate a map and also do the smoothing.
  <DT>
<B><A HREF="fac_anafast.htm#fac:anafast">anafast</A></B>
<DD>This <b>HEALPix</b> facility can analyse a smoothed map.		
  </DL>

<P>
<hr><H1>EXAMPLE # 1:</H1> 
<tt><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT">smoothing</TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE></tt>
<blockquote>
Smoothing runs in interactive mode, self-explanatory. 
</blockquote>

<P>

<P>
<hr><H1>EXAMPLE # 2:</H1> 
<tt><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT">smoothing  filename</TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE></tt>
<blockquote>When `filename' is present, smoothing enters the non-interactive mode and parses
its inputs from the file `filename'. This has the following
structure: the first entry is a qualifier which announces to the parser
which input immediately follows. If this input is omitted in the
input file, the parser assumes the default value.
If the equality sign is omitted, then the parser ignores the entry.
In this way comments may also be included in the file.
In this example, the file contains the following
qualifiers:
<BR>
<tt><A HREF="#fac:smoothing:simul_type">simul_type</A>= 1</tt><br>
<tt><A HREF="#fac:smoothing:nlmax">nlmax</A>= 64</tt><br>
<tt><A HREF="#fac:smoothing:infile">infile</A>= map.fits</tt><br>
<tt><A HREF="#fac:smoothing:outfile">outfile</A>= map_smoothed.fits</tt><br>
<tt><A HREF="#fac:smoothing:fwhm_arcmin">fwhm_arcmin</A>= 10.</tt><br>
<tt><A HREF="#fac:smoothing:iter_order">iter_order</A>= 1</tt><br>
smoothes the <b>HEALPix</b> temperature map contained in `map.fits' with 
a 10 arcmin FWHM beam. The resulting map is saved 
in `map_smoothed.fits'. The map analysis/synthesis was carried 
out using fourier coeffecients up to an <SPAN CLASS="MATH"><I>l</I></SPAN> value of 64. A first
order iteration of the quadrature was performed.</blockquote>

<P>
<hr><H1>RELEASE NOTES</H1><blockquote>
  <DL COMPACT><DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Initial release (<b>HEALPix</b> 0.90)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Extension to polarization and arbitrary <EM>circular</EM> beams (<b>HEALPix</b> 1.20)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Support for pixel-based quadrature weights when <A HREF="fac_anafast.htm#fac:anafast:won"><TT>won=2</TT></A> (<b>HEALPix</b> 3.40)
  </DL>
</blockquote>

<P>

<hr><H1>MESSAGES</H1><h3>This section describes error messages generated by <b><FONT COLOR="#CC0000">smoothing</FONT></b>
</h3>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SPAN  CLASS="textbf">Message</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SPAN  CLASS="textbf">Severity</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SPAN  CLASS="textbf">Text</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125>
can not allocate memory for array xxx</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>Fatal</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>You do not have
                   sufficient system resources to run this
                   facility at the map resolution you required. 
  Try a lower map resolution.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
</TR>
</TABLE>

<P>

<P>


<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html254"
  HREF="fac_sky_ng_sim.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html260"
  HREF="fac_HEALPix_F90_facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html264"
  HREF="fac_synfast.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html262"
  HREF="fac_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html255"
  HREF="fac_sky_ng_sim.htm">sky_ng_sim</A>

<B>Up:</B> <A NAME="tex2html261"
  HREF="fac_HEALPix_F90_facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A NAME="tex2html265"
  HREF="fac_synfast.htm">synfast</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.40, 2018-06-22
</ADDRESS>
</BODY>
</HTML>
