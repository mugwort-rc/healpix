<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tga_image.h Source File</title>
<link href="sheet.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>tga_image.h</h1><a href="tga__image_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> *  This file is part of Healpix_cxx.</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  Healpix_cxx is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> *  (at your option) any later version.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> *  Healpix_cxx is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> *  GNU General Public License for more details.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> *  along with Healpix_cxx; if not, write to the Free Software</span>
00016 <span class="comment"> *  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> *  For more information about HEALPix, see http://healpix.jpl.nasa.gov</span>
00019 <span class="comment"> */</span>
00020 
00021 <span class="comment">/*</span>
00022 <span class="comment"> *  Healpix_cxx is being developed at the Max-Planck-Institut fuer Astrophysik</span>
00023 <span class="comment"> *  and financially supported by the Deutsches Zentrum fuer Luft- und Raumfahrt</span>
00024 <span class="comment"> *  (DLR).</span>
00025 <span class="comment"> */</span>
00026 <span class="comment"></span>
00027 <span class="comment">/*! \file tga_image.h</span>
00028 <span class="comment"> *  Classes for creation and output of TGA image files</span>
00029 <span class="comment"> *</span>
00030 <span class="comment"> *  Copyright (C) 2003, 2006 Max-Planck-Society</span>
00031 <span class="comment"> *  \author Martin Reinecke, David Larson</span>
00032 <span class="comment"> */</span>
00033 
00034 <span class="preprocessor">#ifndef PLANCK_TGA_IMAGE_H</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define PLANCK_TGA_IMAGE_H</span>
00036 <span class="preprocessor"></span>
00037 <span class="preprocessor">#include &lt;string&gt;</span>
00038 <span class="preprocessor">#include &lt;vector&gt;</span>
00039 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00040 <span class="preprocessor">#include "<a class="code" href="arr_8h.html">arr.h</a>"</span>
00041 <span class="comment"></span>
00042 <span class="comment">/*! \defgroup imagegroup Image creation */</span><span class="comment"></span>
00043 <span class="comment">/*! \{ */</span>
00044 <span class="comment"></span>
00045 <span class="comment">/*! A very simple class for storing RGB colours. */</span>
<a name="l00046"></a><a class="code" href="classColour.html">00046</a> <span class="keyword">class </span><a class="code" href="classColour.html">Colour</a>
00047   {
00048   <span class="keyword">public</span>:
<a name="l00049"></a><a class="code" href="classColour.html#o0">00049</a>     <span class="keywordtype">float</span> <a class="code" href="classColour.html#o0">r</a>, <span class="comment">/*!&lt; the red component */</span>
00050           <a class="code" href="classColour.html#o1">g</a>, <span class="comment">/*!&lt; the green component */</span>
00051           <a class="code" href="classColour.html#o2">b</a>; <span class="comment">/*!&lt; the blue component */</span>
00052 <span class="comment"></span>
00053 <span class="comment">    /*! Default constructor. Does not initialize \a r, \a g and \a b. */</span>
<a name="l00054"></a><a class="code" href="classColour.html#a0">00054</a>     <a class="code" href="classColour.html#a0">Colour</a>() {}<span class="comment"></span>
00055 <span class="comment">    /*! Initializes the colour with \a R, \a G and \a B. */</span>
<a name="l00056"></a><a class="code" href="classColour.html#a1">00056</a>     <a class="code" href="classColour.html#a0">Colour</a> (<span class="keywordtype">float</span> R, <span class="keywordtype">float</span> G, <span class="keywordtype">float</span> B) : <a class="code" href="classColour.html#o0">r</a>(R), <a class="code" href="classColour.html#o1">g</a>(G), <a class="code" href="classColour.html#o2">b</a>(B) {}<span class="comment"></span>
00057 <span class="comment">    /*! Multiplies all components with \a fact. */</span>
<a name="l00058"></a><a class="code" href="classColour.html#a2">00058</a>     <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;<a class="code" href="classColour.html#a2">operator*= </a>(<span class="keywordtype">float</span> fact)
00059       { <a class="code" href="classColour.html#o0">r</a>*=fact; <a class="code" href="classColour.html#o1">g</a>*=fact; <a class="code" href="classColour.html#o2">b</a>*=fact; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }<span class="comment"></span>
00060 <span class="comment">    /*! Returns the sum colour of \a *this and \a c2. */</span>
<a name="l00061"></a><a class="code" href="classColour.html#a3">00061</a>     <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> <a class="code" href="classColour.html#a3">operator+ </a>(<span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;c2)<span class="keyword"> const</span>
00062 <span class="keyword">      </span>{ <span class="keywordflow">return</span> <a class="code" href="classColour.html#a0">Colour</a>(<a class="code" href="classColour.html#o0">r</a>+c2.<a class="code" href="classColour.html#o0">r</a>, <a class="code" href="classColour.html#o1">g</a>+c2.<a class="code" href="classColour.html#o1">g</a>, <a class="code" href="classColour.html#o2">b</a>+c2.<a class="code" href="classColour.html#o2">b</a>); }<span class="comment"></span>
00063 <span class="comment">    /*! Returns \a *this, scaled by \a f. */</span>
<a name="l00064"></a><a class="code" href="classColour.html#a4">00064</a>     <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> <a class="code" href="classColour.html#a4">operator* </a>(<span class="keywordtype">double</span> f)<span class="keyword"> const</span>
00065 <span class="keyword">      </span>{ <span class="keywordflow">return</span> <a class="code" href="classColour.html#a0">Colour</a>(<a class="code" href="classColour.html#o0">r</a>*f, <a class="code" href="classColour.html#o1">g</a>*f, <a class="code" href="classColour.html#o2">b</a>*f); }
00066   };
00067 <span class="comment"></span>
00068 <span class="comment">/*! A class for mapping floting-point values into colours. */</span>
<a name="l00069"></a><a class="code" href="classPalette.html">00069</a> <span class="keyword">class </span><a class="code" href="classPalette.html">Palette</a>
00070   {
00071   <span class="keyword">private</span>:
00072     std::vector&lt;Colour&gt; cv;
00073     std::vector&lt;float&gt; fv;
00074 
00075   <span class="keyword">public</span>:<span class="comment"></span>
00076 <span class="comment">    /*! Adds a new data point \a f, with the corresponding colour \a c.</span>
00077 <span class="comment">        The additions must be done in the order of ascending \a f. */</span>
<a name="l00078"></a><a class="code" href="classPalette.html#a0">00078</a>     <span class="keywordtype">void</span> <a class="code" href="classPalette.html#a0">add</a> (<span class="keywordtype">float</span> f, <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;c)
00079       {
00080       fv.push_back(f);
00081       cv.push_back(c);
00082       }<span class="comment"></span>
00083 <span class="comment">    /*! Sets the palette to the predefined palette \a num. */</span>
00084     <span class="keywordtype">void</span> <a class="code" href="classPalette.html#a1">setPredefined</a>(<span class="keywordtype">int</span> num);<span class="comment"></span>
00085 <span class="comment">    /*! Returns the colour corresponding to the value \a f. The colour is</span>
00086 <span class="comment">        determined by linear interpolation between neighbouring data points. */</span>
<a name="l00087"></a><a class="code" href="classPalette.html#a2">00087</a>     <a class="code" href="classColour.html">Colour</a> <a class="code" href="classPalette.html#a2">Get_Colour</a> (<span class="keywordtype">float</span> f)<span class="keyword"> const</span>
00088 <span class="keyword">      </span>{
00089       <span class="keywordflow">if</span> (f&lt;=fv[0]) <span class="keywordflow">return</span> cv[0];
00090       <span class="keywordflow">if</span> (f&gt;=fv[fv.size()-1]) <span class="keywordflow">return</span> cv[cv.size()-1];
00091       <span class="keywordtype">int</span> i=0;
00092       <span class="keywordflow">while</span> (f&gt;fv[i]) ++i;
00093       <span class="keywordflow">return</span> cv[i-1]*((fv[i]-f)/(fv[i]-fv[i-1]))
00094            + cv[i]*((f-fv[i-1])/(fv[i]-fv[i-1]));
00095       }
00096   };
00097 
00098 <span class="keyword">class </span>Colour8
00099   {
00100   <span class="keyword">private</span>:
00101     <span class="keywordtype">void</span> <span class="keyword">import</span> (<span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col)
00102       {
00103       <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00104       r = max(0,min(255,<span class="keywordtype">int</span>(col.r*256)));
00105       g = max(0,min(255,<span class="keywordtype">int</span>(col.g*256)));
00106       b = max(0,min(255,<span class="keywordtype">int</span>(col.b*256)));
00107       }
00108 
00109   <span class="keyword">public</span>:
00110     <span class="keywordtype">char</span> r,g,b;
00111 
00112     Colour8() {}
00113     Colour8 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> R, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> G, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> B)
00114       : r(R), g(G), b(B) {}
00115     Colour8 (<span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col)
00116       { <span class="keyword">import</span> (col); }
00117     <span class="keyword">const</span> Colour8 &amp;operator= (<span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col)
00118       { <span class="keyword">import</span> (col); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
00119     <span class="keywordtype">bool</span> operator== (<span class="keyword">const</span> Colour8 &amp;that)
00120       { <span class="keywordflow">return</span> (r == that.r) &amp;&amp; (g == that.g) &amp;&amp; (b == that.b); }
00121     <span class="keywordtype">bool</span> operator!= (<span class="keyword">const</span> Colour8 &amp;that)
00122       { <span class="keywordflow">return</span> (r != that.r) || (g != that.g) || (b != that.b); }
00123   };
00124 
00125 <span class="keyword">class </span>Font
00126   {
00127   <span class="keyword">public</span>:
00128     <span class="keywordtype">int</span> offset, num_chars, xpix, ypix;
00129     <span class="keyword">const</span> <span class="keywordtype">char</span> *data;
00130   };
00131 
00132 <span class="keyword">extern</span> <span class="keyword">const</span> Font medium_bold_font;
00133 <span class="keyword">extern</span> <span class="keyword">const</span> Font giant_font;
00134 <span class="comment"></span>
00135 <span class="comment">/*! Class for creating and storing TGA image files. */</span>
<a name="l00136"></a><a class="code" href="classTGA__Image.html">00136</a> <span class="keyword">class </span><a class="code" href="classTGA__Image.html">TGA_Image</a>
00137   {
00138   <span class="keyword">private</span>:
00139     Font font;
00140     <a class="code" href="classarr2.html">arr2&lt;Colour8&gt;</a> pixel;
00141 
00142     <span class="keywordtype">void</span> write_char (<span class="keywordtype">int</span> xpos, <span class="keywordtype">int</span> ypos, <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col, <span class="keywordtype">char</span> c,
00143                      <span class="keywordtype">int</span> scale=1);
00144 
00145   <span class="keyword">public</span>:<span class="comment"></span>
00146 <span class="comment">    /*! */</span>
00147     <a class="code" href="classTGA__Image.html#a1">TGA_Image</a> ();<span class="comment"></span>
00148 <span class="comment">    /*! Creates an image object with a resolution of \a xres by \a yres. */</span>
00149     <a class="code" href="classTGA__Image.html#a1">TGA_Image</a> (<span class="keywordtype">int</span> xres, <span class="keywordtype">int</span> yres);<span class="comment"></span>
00150 <span class="comment">    /*! */</span>
00151     ~<a class="code" href="classTGA__Image.html">TGA_Image</a> () {}
00152 <span class="comment"></span>
00153 <span class="comment">    /*! Fills the entire image with colour \a col. */</span>
<a name="l00154"></a><a class="code" href="classTGA__Image.html#a3">00154</a>     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a3">fill</a> (<span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col) { pixel.<a class="code" href="classarr2.html#a10">fill</a>(col); }<span class="comment"></span>
00155 <span class="comment">    /*! Sets the font used for annotations to \a fnt. */</span>
00156     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a4">set_font</a> (<span class="keyword">const</span> Font &amp;fnt);<span class="comment"></span>
00157 <span class="comment">    /*! Outputs the string \a text in colour \a col.</span>
00158 <span class="comment">        \a xpos, \a ypos is the lower left corner;</span>
00159 <span class="comment">        the font is scaled by \a scale. */</span>
00160     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a5">annotate</a> (<span class="keywordtype">int</span> xpos, <span class="keywordtype">int</span> ypos, <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col,
00161       <span class="keyword">const</span> std::string &amp;text, <span class="keywordtype">int</span> scale=1);<span class="comment"></span>
00162 <span class="comment">    /*! Outputs the string \a text centered at position \a xpos, \a ypos</span>
00163 <span class="comment">        in colour \a col. The font is scaled by \a scale. */</span>
00164     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a6">annotate_centered</a> (<span class="keywordtype">int</span> xpos, <span class="keywordtype">int</span> ypos, <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col,
00165       <span class="keyword">const</span> std::string &amp;text, <span class="keywordtype">int</span> scale=1);<span class="comment"></span>
00166 <span class="comment">    /*! Sets the pixel \a i, \a j, to the colour \a col. */</span>
<a name="l00167"></a><a class="code" href="classTGA__Image.html#a7">00167</a>     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a7">put_pixel</a> (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keyword">const</span> <a class="code" href="classColour.html">Colour</a> &amp;col)
00168       {
00169       <span class="keywordflow">if</span> ((i&gt;=0) &amp;&amp; (i&lt;pixel.<a class="code" href="classarr2.html#a4">size1</a>()) &amp;&amp; (j&gt;=0) &amp;&amp; (j&lt;pixel.<a class="code" href="classarr2.html#a5">size2</a>()))
00170         pixel[i][j] = col;
00171       }<span class="comment"></span>
00172 <span class="comment">    /*! Returns the colour of the pixel \a i, \a j, or black if the pixel</span>
00173 <span class="comment">        lies outside of the image. */</span>
<a name="l00174"></a><a class="code" href="classTGA__Image.html#a8">00174</a>     Colour8 <a class="code" href="classTGA__Image.html#a8">get_pixel</a> (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j)
00175       {
00176       <span class="keywordflow">if</span> ((i&gt;=0) &amp;&amp; (i&lt;pixel.<a class="code" href="classarr2.html#a4">size1</a>()) &amp;&amp; (j&gt;=0) &amp;&amp; (j&lt;pixel.<a class="code" href="classarr2.html#a5">size2</a>()))
00177         <span class="keywordflow">return</span> pixel[i][j];
00178       <span class="keywordflow">else</span>
00179         <span class="keywordflow">return</span> Colour8(0, 0, 0);
00180       }
00181 <span class="comment"></span>
00182 <span class="comment">    /*! Writes the image to \a file. */</span>
00183     <span class="keywordtype">void</span> <a class="code" href="classTGA__Image.html#a9">write</a> (<span class="keyword">const</span> std::string &amp;file) <span class="keyword">const</span>;
00184   };
00185 <span class="comment"></span>
00186 <span class="comment">/*! \} */</span>
00187 
00188 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>
Generated on Thu Feb 19 17:23:13 2009 for LevelS C++ support library
</a> </small></address>
</body>
</html>
