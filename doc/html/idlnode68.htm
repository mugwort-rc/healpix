<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>write_fits_sb</TITLE>
<META NAME="description" CONTENT="write_fits_sb">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idlnode69.htm">
<LINK REL="previous" HREF="idlnode67.htm">
<LINK REL="up" HREF="idl.htm">
<LINK REL="next" HREF="idlnode69.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html1001"
  HREF="idlnode67.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1007"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1011"
  HREF="idlnode69.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1009"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1002"
  HREF="idlnode67.htm">write_fits_map</A>

<B>Up:</B> <A NAME="tex2html1008"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html1012"
  HREF="idlnode69.htm">write_tqu</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000680000000000000000"></A>
<A NAME="idl:write_fits_sb"></A>
<BR>
 
</H1>
<P>
<b><font size=+6><FONT COLOR="#CC0000">write_fits_sb</FONT></font></b><hr>
<H3>This IDL facility writes out a <b>HEALPix</b> map into a FITS file according to
the <b>HEALPix</b> convention. It can also write an arbitray data set into a FITS
binary table</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/502/tree/trunk/src/idl/fits/write_fits_sb.pro"><b>src/idl/fits/write_fits_sb.pro</b></a>&nbsp;  
<P>
<hr><h1>FORMAT </h1><h3>IDL>
WRITE_FITS_SB , File, Prim_Stc [, Xten_stc, Coordsys=, /Nested, /Ring,
Ordering=, /Partial, Nside=, Extension=, /Nothealpix]

</h3>
<P>
<hr>
<H1>QUALIFIERS</H1>
 
  </SMALL><DL COMPACT><DT>
<B>File</B>
<DD>name of a FITS file in which the map is to be written

<P>
<DT>
<B>Prim_stc</B>
<DD>IDL structure containing the following fields: 
<BR>		- primary header 
<BR>		- primary image 
<BR>
Set it to 0 to get an empty primary unit

<P>
<DT>
<B>Xten_stc</B>
<DD>(optional), 
<BR>
IDL structure containing the following fields: 
<BR>		- extension header  
<BR>		- data column 1  
<BR>		- data column 2   
<BR>		... 
<BR>
NB: because of some astron routines limitation, avoid using the single letters
		  'T' or 'F' as tagnames in the structures Prim_stc and Xten_stc.

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>KEYWORDS</H1>

  </SMALL><DL COMPACT><DT>
<B>Coordsys=</B>
<DD>(optional), 
<BR>
if set to either 'C', 'E' or 'G',  specifies that the
		Healpix coordinate system is respectively Celestial=equatorial,
		  Ecliptic or Galactic.
		(The relevant keyword is then added/updated in the extension
		  header, but the map is NOT rotated)

<P>
<DT>
<B>Ordering=</B>
<DD>(optional), 
<BR>
if set to either 'ring' or 'nested' (case un-sensitive),
		  specifies that the map is respectively in RING or NESTED
		  ordering scheme
<BR>		<i>see also:</i>Nested and Ring

<P>
<DT>
<B>Nside=</B>
<DD>(optional), 
<BR>
scalar integer, <b>HEALPix</b> resolution parameter of the
		data set. Must be used when the data set does not
		cover the whole sky

<P>
<DT>
<B>Extension=</B>
<DD>(optional), 
<BR>
scalar integer, extension in which to write the data
		(0 based).
<BR>		<b>default:</b>0

<P>
<DT>
<B>/Nested</B>
<DD>(optional), 
<BR>
if set, specifies that the map is in the NESTED ordering
	scheme
<BR>	<i>see also:</i>Ordering and Ring 

<P>
<DT>
<B>/Ring</B>
<DD>(optional), 
<BR>
if set, specifies that the map is in the RING ordering
	scheme
<BR>	<i>see also:</i>Ordering and Nested

<P>
<DT>
<B>/Partial</B>
<DD>(optional), 
<BR>
if set, the data set does not cover the whole sky. In
	that case the information on the actual map resolution should be given by the
	qualifier Nside (see above), or included in the FITS header enclosed in
	the Xten_stc.

<P>
<DT>
<B>/Nothealpix</B>
<DD>(optional), 
<BR>
if set, the data set can be arbitrary, and the
	restriction on the number of pixels do not apply. The keywords <TT>	Ordering</TT>, <TT>Nside</TT>, <TT>Nested</TT>, <TT>Ring</TT> and <TT>Partial</TT> are ignored.

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>
<br><br>box[t]write_fits_sb writes out the information contained in <TT>Prim_stc and <TT>Exten_stc in the primary unit and extension of the FITS file
<TT>File respectively . Coordinate systems can also be specified by <TT>Coordsys. Specifying the
ordering scheme is compulsary for <b>HEALPix</b> data sets and can be done either in <TT>Header or by setting <TT>
Ordering or <TT>Nested or <TT>Ring to the correct value. If <TT>
Ordering or <TT>Nested or <TT>Ring is set, its value overrides what is
given in <TT>Header. 
<BR><br><br>
The data is assumed to represent a full sky data set with 
the number of data points npix = 12*Nside*Nside
unless   <BR>
Partial is set <EM>or the input FITS header contains OBJECT =
               'PARTIAL' <BR>
AND <BR>
the Nside qualifier is given a valid value <EM>or the FITS header contains
                 a NSIDE.
<BR><br><br>
In the <b>HEALPix</b> scheme, invalid or missing pixels should be given the value <TT>
!healpix.bad_valuetex2html_wrap_inline$= -1.63750 10^30$.
<BR><br><br>
If <TT>Nothealpix is set, the restrictions on Nside are void.</TT></TT></EM></EM></TT></TT></TT></TT></TT></TT></TT></TT></TT></TT></TT></TT>
</blockquote>
<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">write_fits_sb</FONT></b></h3>
 
  </SMALL><DL COMPACT><DT>
<B>idl</B>
<DD>version 6.1 or more is necessary to run <FONT COLOR="#CC0000">write_fits_sb</FONT>
  <DT>
<B><A HREF="idlnode56.htm#idl:read_fits_map">read_fits_map</A></B>
<DD>This <b>HEALPix</b> IDL facility can be used to read in maps
  written by <FONT COLOR="#CC0000">write_fits_sb</FONT>.
  <DT>
<B><A HREF="idlnode57.htm#idl:read_fits_s">read_fits_s</A></B>
<DD>This <b>HEALPix</b> IDL facility can be used to read
  into an IDL structure maps written by <FONT COLOR="#CC0000">write_fits_sb</FONT>.
  <DT>
<B>sxaddpar</B>
<DD>This IDL routine (included in <b>HEALPix</b> package) can be used to update
  or add FITS keywords to the header in <TT>Prim_stc</TT> and <TT>Exten_stc</TT>
  <DT>
<B><A HREF="idlnode66.htm#idl:write_fits_cut4">write_fits_cut4</A>,
<A HREF="idlnode67.htm#idl:write_fits_map">write_fits_map</A></B>
<DD><DT>
<B><A HREF="idlnode69.htm#idl:write_tqu">write_tqu</A>,
<A HREF="#idl:write_fits_sb">write_fits_sb</A></B>
<DD><b>HEALPix</b> IDL routines to write cut-sky maps, full-sky maps, polarized full-sky maps and
arbitrary data sets into FITS files
  <DT>
<B><A HREF="idlnode69.htm#idl:write_tqu">write_tqu</A></B>
<DD>This <b>HEALPix</b> IDL facility based on <FONT COLOR="#CC0000">write_fits_sb</FONT> is designed to write
  temperature+polarization (T,Q,U) maps
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<HR><H1>EXAMPLE:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> npix =  <A HREF="idlnode46.htm#idl:nside2npix">nside2npix</A>(128) </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> f=  randomn(seed,npix) </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> n=  lindgen(npix)+3 </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> map_FN =  create_struct('HDR',[' '],'FLUX',f,'NUMBER',n) </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">write_fits_sb</FONT>,  'map_fluxnumber.fits', 0, map_FN, coord='G', /ring</SMALL></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>
The structure map_FN is defined to contain a fictitious Flux<SPAN CLASS="MATH">+</SPAN>number map, where
one field is a float and the other an integer.
<FONT COLOR="#CC0000">write_fits_sb</FONT> writes out the contents of map_FN into the extension 
of the FITS file 'map_fluxnumber.fits'.
</blockquote>
<P>

<P>
<SMALL CLASS="FOOTNOTESIZE">
 </SMALL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1001"
  HREF="idlnode67.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1007"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1011"
  HREF="idlnode69.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1009"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1002"
  HREF="idlnode67.htm">write_fits_map</A>

<B>Up:</B> <A NAME="tex2html1008"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html1012"
  HREF="idlnode69.htm">write_tqu</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.11, 2013-04-24
</ADDRESS>
</BODY>
</HTML>
